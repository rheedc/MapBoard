<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC 
				"-//mybatis.org//DTD Mapper 3.0//EN" 
				"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
				
<!-- select m_id as id , m_password as pw, m_nick as nick  from member where m_id=user입력ID? and m_password=user입력PW; 를 만들어 보자 -->
<mapper namespace="fileinfo">
	<!-- ex)<select id="loginChk" parameterType="hmap" resultType="hmap"> -->

	<!-- 자주 사용되는 명령은 한번만  만들어 놓는다. -->
	<sql id="selectFile">
		SELECT
			fidx,
			bidx,
			fpath,
			foriname,
			fsname,
			fsize
		FROM
			FileInfo 
	</sql>

	
	<!-- 파일 등록 -->
	<insert id="insertFileInfo" parameterType="FileinfoVO">
		INSERT INTO
			FileInfo
		VALUES ((SELECT NVL(MAX(fidx),0)+1 FROM FileInfo),
							#{bidx},#{fpath},#{foriname},#{fsname},#{fsize})
	</insert>
	
	
	<!-- 첨부파일 검색 질의 -->
	<select id="fileInfo"	parameterType="int" resultType="fileinfoVO">
		<include refid="selectFile"/> 
		WHERE
			bidx = #{oriNo}
	</select>
	
	<!-- 다운로드 파일 정보 검색 질의 -->
	<select id="download"	parameterType="int" resultType="fileinfoVO">
		<include refid="selectFile"/> 
		WHERE
			fidx = #{fileNo}
	</select>	
	
</mapper>